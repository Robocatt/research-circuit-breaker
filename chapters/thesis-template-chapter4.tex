\chapter{Реализация и сравнительное тестирование системы.}

\textbf{Аннотация.} \textit{В данном разделе представлено комплексное описание реализации и тестирования системы. Детально рассмотрен процесс программирования основных компонентов и их интеграции в общую архитектуру. Рассмотрены детали реализаций микросервисов, на которые будут приходить запросы. Объяснено как развертываются компоненты в кластере. Особое внимание уделено способу сбора трассировки, настройке сборщика данных и конфигурации Jaeger. Разъясняется конфигурация service mesh в Istio, в сравнении с самостоятельно реализованной альтернативой. Описаны методики тестирования, позволяющие оценить производительность и отказоустойчивость системы. Приводятся результаты эксперементов нагрузочного тестирования. Строятся, сравниваются и объясняются графики задержек в каждой из реализаций.  Рассмотрены перспективы и возможности дальнейшнего развития исследования.}

% Фрагменты программного кода в тексте необходимо выделять при помощи команды 
% \verb|\verb|. Многострочные листинги должны оформляться при помощи пакета 
% \verb|listings|. Пример:

% \begin{lstlisting}
% # let s x y z = x z (y z);;
% val s : ('a -> 'b -> 'c) -> ('a -> 'b) -> 'a -> 'c = <fun>
% # let k x y = x;;
% val k : 'a -> 'b -> 'a = <fun>
% # let i = s k k;;
% val i : '_a -> '_a = <fun>
% \end{lstlisting}

% Листинг \ref{lst:float-example} иллюстрирует использование выносных листингов.
% Листинг \ref{lst:HelloWorld.scala} показывает пример включения внешнего файла 
% в качестве листинга, в данном случае --- выносного.

% \begin{lstlisting}[
%   float=tb,frame=lines,label=lst:float-example,caption=Выносной листинг
% ]
% List myList = new List();
% Element myElement = new Element();
% myList.Append(myElement);
% \end{lstlisting}

% \lstinputlisting[
%   label=lst:HelloWorld.scala,
%   float=tb,frame=lines,
%   caption=Листинг из файла \texttt{HelloWorld.scala}
% ]{listings/HelloWorld.scala}

% \section{Выбор инструментальных средств}

% В этом разделе обосновывается выбор инструментальных средств; одним из критериев выбора могут быть какие-либо требования к разрабатываемой системе, и если этих требований много, они могут быть выделены в отдельный раздел, или же в приложение. Этот пункт не пишется, если в аналитической главе был раздел, посвященный сравнительному анализу и выбору инструментальных средств.


\section{Состав и структура реализованного программного обеспечения}

\textbf{Аннотация. } \textit{Архитектура представлена в виде двух параллельных кластеров виртуальных машин, управляемых посредством k3s. Каждый кластер состоит из трёх виртуальных машин, одна из которых является главной. Микросервисами выступают Flask веб серверы, написанные на Python.  Развертывание компонентов системы осуществляется через Helm-чарты с использованием YAML-конфигураций, что упрощает масштабирование и обновление. На ноде не содержащей микросервисов, развернут инструмент k6, симулирующий нагрузку и моделирующий реальные сценарии эксплуатации системы.  Система трассировки Jaeger также работает на ноде без микросервисов. Для обеспечения контроля и анализа работы компонентов на каждой ноде развернут сборщики трейсов fluentbit в виде daemon set, передающих данные в систему Jaeger. }

В данной главе описана структура реализованного программного обеспечения, в основе которого лежит микросервисная архитектура, развернутая на кластере виртуальных машин с использованием k3s. Написан шаблон Python кода сервера (\ref{lst:server.py}), реализована версии с Istio, написана библиотека с реализацией паттерна Circuit Breaker. Для реализации веб-сервисов использован Flask, запущенный через Gunicorn для повышения производительности, что позволяет эффективно обрабатывать входящие запросы. Все компоненты упакованы в Docker-образы и опубликованы на Docker Hub. Приведён листинг Docker-файла сервера (\ref{lst:dockerfile-server}), а так же листинг Docker-файла прокси-сервера (\ref{lst:dockerfile-proxy}).

Развертывание компонентов системы осуществляется посредством Helm-чартов, где все параметры заданы в файле values.yaml (\ref{lst:values}). Такой подход обеспечивает гибкую конфигурацию и автоматизацию обновлений, позволяя централизованно управлять параметрами развертывания в кластере. 
\lstinputlisting[
  label=lst:server.py,
  float=tb,
  frame=lines,
  caption=Листинг из файла \texttt{server.py},
  basicstyle=\footnotesize\ttfamily
]{listings/server.py}

\lstinputlisting[
  label=lst:dockerfile-server,
  float=tb,frame=lines,
  caption=Листинг из файла \texttt{Dockerfile} сервера
]{listings/docker-server}

\lstinputlisting[
  label=lst:dockerfile-proxy,
  float=tb,frame=lines,
  caption=Листинг из файла \texttt{Dockerfile} прокси сервера
]{listings/docker-proxy}

\lstinputlisting[
  label=lst:values,
  float=tb,
  frame=lines,
  caption=Листинг из файла \texttt{values.yaml},
  basicstyle=\footnotesize\ttfamily
]{listings/helm/values.yaml}




\section{Основные сценарии использования реализованной библиотеки }

\textbf{Аннотация. } \textit{ Разработана переиспользуемая библиотека с функционалом circuit breaker для повышения устойчивости распределенных приложений. Обоснованы принципы повторного использования кода, позволяющие интегрировать библиотеку в различные системы. Описаны методы настройки через Helm-чарты для проведения экспериментов с разным числом микросервисов. Показан способ добавления и изменения отслеживаемых трейсов для анализа работоспособности системы. Объяснены методы построения наглядных графиков задержек в проекте.}


\section{Результаты тестирования}

\textbf{Аннотация. } \textit{Разработана методика тестирования ключевых сценариев эксплуатации системы, направленная на оценку её производительности и отказоустойчивости. Проведены нагрузочные тесты, предусматривающие постепенное увеличение числа виртуальных пользователей и количества запросов в секунду, что имитирует пиковые периоды активности.  Проведены тест с увеличением размера запроса, при котором фиксированное число одновременных обращений обрабатывает всё более объёмные данные. Результаты тестирования представлены в виде таблиц и графиков, позволяющих наглядно оценить зависимость производительности от параметров нагрузки.}

% \textit{\textbf{Замечание.}} В ПЗ (как УИРа, так и ВКР) следует избегать ситуаций, когда значительную часть основного содержания составляют страницы с иллюстрациями и таблицами, особенно, если такие страницы следуют подряд. В основном тексте следует оставлять лишь самые основные таблицы и рисунки, а остальное --- выносить в приложение.



\section{Выводы}
\textbf{Аннотация. } \textit{В данном разделе подводятся итоги разработки и исследования решения, направленного на обеспечение отказоустойчивости распределённых систем с использованием механизма circuit breaker. Суммируются достигнутые практические результаты, включающие создание программного обеспечения,библиотеки на Python, разработку методик тестирования и формирование набора тестовых примеров для оценки задержек в работе паттерна. Анализируется степень эффективности промышленного решения и библиотеки. Оцениваются перспективы интеграции разработанного ПО в комплексные информационные системы, а также направления для дальнейших исследований.}


%%% Local Variables:
%%% TeX-engine: xetex
%%% eval: (setq-local TeX-master (concat "../" (seq-find (-cut string-match ".*-3-pz\.tex$" <>) (directory-files ".."))))
%%% End:
